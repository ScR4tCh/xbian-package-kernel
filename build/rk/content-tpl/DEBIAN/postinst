#!/bin/bash

KVER="__KVER__"
export KVER

if [ $1 == "configure" ]; then

        [ -h /lib/modules/$KVER.xbian/build ] && mv /lib/modules/$KVER.xbian/build /lib/modules/$KVER
        [ -d /lib/modules/$KVER.xbian ] && rm -fr /lib/modules/$KVER.xbian || true

        insserv -fr rng-tools &>/dev/null
        udevadm control --reload-rules || :

        if [ "$(xbian-arch)" = rk ]; then

cat << \EOF > /tmp/idb_sector_0.hex
55aaf00f0000000000000000040004000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000020000004
0000
EOF

					xxd -r -ps /tmp/idb_sector_0.hex /tmp/idb_sector_0

					echo "d169f04b4d36f144a05d45728f677183  /tmp/idb_sector_0" > /tmp/md5check

					if [ $(md5sum -c /tmp/md5check 1>/dev/null 2>/dev/null) ]; then
						echo "idb_sector_0 md5check failed!";
						exit 1
					fi

					dd if=/tmp/idb_sector_0 conv=sync 2>/dev/null | split -b 512 --filter='openssl rc4 -K 7C4E0304550509072D2C7B38170D1711' > /tmp/idb_sector_0.enc
					rm /tmp/idb_sector_0 /tmp/md5check /tmp/idb_sector_0.hex

cat << \EOF > /tmp/idb_sector_1.hex
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000001000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
0000
EOF

					xxd -r -ps /tmp/idb_sector_1.hex /tmp/idb_sector_1

					echo "b1b689567e867239be7aef0980892db6  /tmp/idb_sector_1" > /tmp/md5check

					if [ $(md5sum -c /tmp/md5check 1>/dev/null 2>/dev/null) ]; then
						echo "idb_sector_1 md5check failed!";
						exit 1
					fi
					rm /tmp/md5check /tmp/idb_sector_1.hex

cat << \EOF > /tmp/memory_300Mhz.hex
524b3332300f1fee010a80e3300f0fee00009fe510ff2fe11d4c70ff28b1
012805d0022805d0f7a004e0faa002e0fba000e0fca000f022bf70b5fca0
00f01efffd4c0825216891f8241005fa01f000f03afff5a000f012fff8a0
00f00fff2068c06900f030fff0a000f008fff5a000f005ff2168012091f8
2010884000f023ffe9a000f0fbfef1a000f0f8fe2068006b00f019ffe4a0
00f0f1feeea000f0eefe2068806900f00fffdfa000f0e7feeaa000f0e4fe
206890f8280005fa00f000f002ffd9a000f0dafe20688169446b012901d9
c06b0444e4a000f0d0fe204600f0f2febde87040e2a000f0c8be2de9f04f
e049d1f89c00c0f3423003287dd005287cd006287bd00325002006460123
d1f89c2003fa00f404ea1272920770d00b24d54a04eb001402eb80121574
d1f89c70e74007f00104092704f1010b07eb0014c2f818b0d1f89c70e740
07f00304082704f1090a07eb0014c2f81ca0d1f89c70e740022407f00107
c7f1030904eb0017c2f82090d1f89cc02cfa07fc0cf0030724fa07fec2f8
24e0d1f89c704fea001c27fa0cf707f00307fc40946200f11e04d1f89c70
e74007f001080627c2f82c8007eb0014d1f89c70e740761c07f0030c09eb
0e070cf10d0cbbf1010f0ceb0a042744a7f1140703fa07f4c2e90cc414d9
d1f89ce0042707eb00172efa07fe0ef003070d37aceb070c03e028e025e0
22e00fe024fa0cfcc2e90e7cb8f1000f08d004eb4407d46bbf08576304eb
4404a408d463401c0228fff472afd1f89c00c0f30030401cb04204d00321
8f48017480f85010bde8f08f00255ee701255ce70020022506465ae72de9
f04f0021764889b0dff81892022400680491d0f800a04569204602f0a9fc
02f001fd30b9012002f0a3fc012402f0fafc38b14ff0ff3028602868401c
03d07aa050e17ca04ee1754f02200323d7f89c2000eb0a11e0408b408840
9a430243c7f89c20214602a802f08dfc029e4ff0000b4ff001080ee03219
c5f800b0521e08fa02f02844c0f800900168494501d1286810b1761e092e
eed2082e33d00922d7f89c30032102eb0a12a6f10900914090408b430343
c7f89c30224602a903a802f074fc00202860dde9020101442144491e08fa
01f12944c1f800900a684a4501d1296889b10221d7f89c2008238b460121
03eb0a108140bbf1030f22ea010205d0012104e04fa0ede00321ece70021
b84681400a43c7f89c20234602aa03a906a802f05ffc069f4ff0000e12e0
c5f800e0039802993844084401190120491e88402844c0f8009001684945
01d1286810b17f1e0c2fead20b2f7cd0414606224ff0030c51f89c3f02eb
0a12a7f10d000cfa02fc904023ea0c03002203434ff0010c0b602a600398
029b3a181a442244531e0cfa03f3921e0cfa02f05a191044c0f800900268
4a4557d1286854e0556e6b6f776e204465766963650a00004c5044445233
20004c5044445232200044445233200000004275732057696474683d0000
407570ff436f6c3d0000000042616e6b3d000000526f773d000000004353
3d00446965204275732d57696474683d000053697a653d0000004d420a00
000073ff647770ff0ff0a55a5720464620213d20520a0000313662697420
6572726f722121210a00436f6c206572726f722121210a00000045e008b1
012004900120f94a0af11e0807eb060e52f89c3f0eeb0b0cddf810e000fa
08f18b430ceb04010efa08fe143943ea0e038840059013603a46cde90064
02205b46114602f088fc002822d0059802f0d2fb002807901cd00b22e449
4ff0010c02eb0a1251f89c3f0cfa02fc401e904023ea0c03034307980b60
012835d9059800230122b84605eb005015e0d9a000f09efc80e008eb0b01
036031442144491e02fa01f10144c1f800900d684d4501d1016821b1a8f1
0108b8f10c0fead2b8f10b0f0ed00420c94951f89c2f032300eb0a15a8f1
0d00ab40a8409a4302430a6005e0c7a000f073fcd0e74ff000080798cde9
00645b464246394602f02dfcf0b302f0a3fbba4a02214ff003094fea0a15
c14009fa05fed2f89cc0a940bb4b2cea0e0c4cea010cc2f89cc01968049a
002a079a0f63c1e9094001f1180080e844080498c86204d0059800eb4000
820800e0059a4a630798012801d8c86b18e0c1f8388008eb060304980028
03eb0b0000eb040309d0143b09fa03f0c31700e00ae000eb9370801002e0
0120143b9840c863104409b0fee50020fbe72de9ff5f4ff00008dff868a2
4546dff844b24746dff858924ff0ff344646cdf80880cdf80c800aeb8610
c9f80000027c032a3ed2436ac269cde90023036a826b016b806902f0bbfb
d9f800008069012800d0032002f084fad9f80000406a02f08ffa02f0e7fa
00286fd0d9f80000017c21b101290ad0022911d145e0dbf89c20594622f4
604242f4404206e0dbf89c20594622f4604242f42042c1f89c20c26b416b
0120b040054302a811447f1c40f82610761c022eb6d358466f4a50f89c1f
02eb073221f4805111430160016821f0405141ea05710160012fdde90212
6748114419d04ff40075029f9446aa00ee005310674523d191421cd013dc
a94217d099421cd105241ae0dbf89c20594622f4604242f4c042c0e7ea07
01d0162417e0172415e0b14207d0b1f5005f07d105e0002404e0092402e0
0d2400e01b24974204d19c4502d1112402e048e0671c09d001260a0b0023
09050660c0e90412c0e902332ee002996446614500d82146994231d006dc
b1f5807f2bd0a9422fd1012404e0914229d0b14229d11a24002202230360
c0e9022262460299614500d811460d0b0b0545ea0851c0e9043102990a0b
0905c0e906124fea1c324fea0c51c0e9081244f4f8112e488160012004b0
bde8f09f0024dae70224d8e70324d6e729a000f028fb0020f1e72de9fc5f
244fb8680024dff88090eb46dff874a000f01f0809eb84105346caf80000
017c03297dd2012190f8305090f8206090f824c0027f66441544354401fa
05f56d10009590f838502a443244914049100191d0f814c00cb1172000e0
1620002240f4f810b86064e00000000073ff526f77206572726f72212121
0a0000004353312000000000407570ff647770ff00f0ffffe87770ff0000
74ff436170206e6f7420737570706f7274210a0000005bf82200042802d2
0020bde8fc9f01468d0710d1002a0ceb010501d0009e01e04ff0000605eb
060e01d0009e01e04ff0000645f806e011b14fea5101e8e781071cd10ceb
00050ab1009900e000210d442e68ae4212d068a000f0a0fa284600f0defa
69a000f09afa304600f0d8faaff2a40000e00ee000f091fac5e708b14008
dde7521c186880699042b9d800f002f90028bad0641c022cfff466af48f4
f810b8600120b1e72de9f04700f061fa58a000f074fa5da000f071fa5d48
5d490068884206d15a48401d804710b15aa000f065fa02f090fa5b4c30b1
5ba000f05efafff794fb0120206002f08cfa002878d10025574ea046dff8
5c9109eb85173760d8f8001009b13c7c0de099f81040032c07d100243068
047402f076fa18b9641ce4b2032cf6d3032c03d331680320087428e049a0
00f032fa0db14aa000e04aa000f02cfa2046fff7f9fad8f80000444608b1
02f059fa02f073fb10b1206810b10ee042a022e0002078610db1172000e0
1620424940f4f8108860fff7fcfbb0b3fff7eafa6d1c022db7db99f81010
032903d199f85000032806d0fff7e5fd30b3d8f8000028b107e0aff28860
00f0f6f91ee0fff7cdfed0b131494ff0007300200a681a600ae001ebc004
d4e90235c40004f100740834c4e90035401cb0eb420ff1d328a000f0daf9
0020bde8f087ffe726a000f0d3f9fee77265616420616464722030780000
0000203d2030780000004444522056657273696f6e20312e303020323031
34303633300a0000496e0a00147870ff554d5000504d55206661696c0a00
0000447570ff5352580a00000000407570ff647770ff4368616e6e656c20
00000000623a2000613a2000696e6974206661696c65640a000000000000
74ffe87770ff4f55540a000000004552520a000000002de9f04101211b48
4ff480371a4a0068446900202546403405f180754035174b01fb032144f8
2010401cb842f7d300234ff480722146284602f094fb064610a000f062f9
5eb1002054f8201055f82020914206d00ca000f057f9002607e00da003e0
401cb842efd30ea000f04df93046bde8f081407570ff5ff36e3c0d661900
4d656d6f727920004661696c6564210a00000000436f7079204661696c65
64210a0000004f4b0a000b4810b5094a0168012091420cd1094a0949d2f8
94208a4206d009490748c1f89000fff7a2fe002010bd0000afbeadde1078
70ff000073ff3ca508ef004b00ff000076ff56485749574a0166c0f8f420
704730b552485549554a564b564c574d4166c0f88820c0f8e430c0f8f840
c0f8fc5030bd2de9ff5f8046514892460c464ff47a79962c90e866008de8
660001d808220ee0c82c01d806220ae0b4f5967f01d8042205e0b4f5167f
01d8022200e00122182104fb02f0b0fbf1f0f3b3dff8e0b010273f4b411e
4ff0ff3cdff8f8e0032607eb88070ceb5000dff8f0c0521e1943be404fea
081542ea0e024ff0201740ea0c00cbf85060a5f50a05ef602a606960a860
0120324fb8474ff40010e8600120b8472f4a5df82800d2f88412014204d1
a9f10109b9f1000ff6dcbaf1000f02d0514620468847012100e009e04fea
880081400e43cbf85060002004b0bde8f09f00eb4000c000b0fbf2f0f6e7
1e4a014610b5044601230020fff783ff1b496008086010bd1a4a01230146
032079e7012300220146022074e701230146002218466fe7002301460120
1a466ae70000000076ff3101ff9f3306f73f2890fff305901fb317171f1f
85009f009700ff00347470ff0000ff1f00000f3f0000ff0ff125fdff0000
77ff614c70ff000070ff6f4c70ff44484ff480214ff44002c0f82813c0f8
2c237047404800690a2818d000213d48d0f88822920303d5d0f888225204
00d5e6e7491c2029f3d34ff00411374a4ff0c013c0f82813c0f82c23c0f8
2c33704770b5832132480d22324c03232d4d0126c1600260c360ac67c0f8
986070bd2c49086048694006fcd50020704710b50446fff7c8ff08e00a28
02d10d20fff7efff2078fff7ecff641c20780028f3d1bde81040ade770b5
0a28044607d30a26b4fbf6f52846fff7f6ff06fb15443034e0b2bde87040
d3e710b50446fff7a3ff2046fff7e8ffbde8104092e710b50446000904d0
2009fff7f9ff04f00f040a2c01d2303400e03734e0b2bde81040b7e710b5
0446fff787ff2046fff7e7ffbde8104076e70000000077ff000070ff2a00
3f00000069ff0011003310b519b1fff73bff002010bdbde81040fff73abf
2de9f04f00ebc00197b001eb0011fe4c40f2e732049100eb80010591c0eb
0011129100eb40050599531c099502ebc50502eb4101c0ebc002b1fbf3f1
1091b5fbf3f5129902eb500201f2e731b1fbf3fa02f2e732b2fbf3f90795
21680391c1eb011101eb4102e94901eb82020a21b0fbf1f11161c82102f1
ac0e02f1b008c2e901015910d16000210f910399022902f18c0160d000eb
c003c0ebc004c0eb001500ebc00cc3eb801304930ceb001304eb840c05eb
450440f2e73b06940beb4404c0eb001608940beb4304099400eb8017049b
c6ebc6060beb47040beb46060beb83054ff47a73b4fbf3f404940beb8c04
b6fbf3fcb5fbf3f5b4fbf3f415950194c0ebc00404eb44040beb4404b4fb
f3f41394099cb4fbf3f4bb4e119400eb400404f2e734b4fbf3f404f00305
089cb4fbf3f404f07f040a94069c0bebc404b4fbf3f3c3f309030993039b
012b7ed0002bb3467cd02ce30023b0f5a57f089300d80be0b0f5c87f01d8
012306e040f21523984201d8022300e00323fa2802d20625ab460ce0a04c
04f11005646805eb8404e35c03f00f0b1d0901d12b1f0f93b0f5857f1ed8
0023fa280b6102d843f001030b61abf1050304264e245b07dff848c29f0e
0023c1e90573c2e905460b6823f003030b60dcf80830b3f1806f03d85a23
13e04023e4e7b3f1006f01d86e230ce0b3f1805f01d8a02307e0b3f1005f
02d84ff4967301e04ff4af734ff47a74434303f2e733b3fbf4f3d3614ff4
00748b7100eb8006146506eb40168b686ff3090303f500738b6015620c68
109b65f30b240c600aeb0b042c44671901e04de1b0e2def8004067f31134
6b4fcef80040dcf8044068374ff47a7c0a9437f814703f0a474307f2e737
b7fbfcf707f03f079763614f683737f814703f0a474307f2e737b7fbfcfc
def800706cf30507cef80070594f683737f814404ff47a77240a444304f2
e734b4fbf7f70c6867f35e640c60a5eb0b04a41c546228324f6827f00407
4f60def8007064f35957cef800704ff47a77089ca2e8300806eb500404f2
e734b4fbf7f404f03f0642f834690e6864f314460e60d5630c6865f30f34
0c607c1e042b00d2042303f00f06b9f1040f16640e6863f358560e604e46
d8f8007063f303074ff47a73c8f8007000d2042606f00f0706eb050c5764
0f6866f384070ceb05060af01f0c361fbaf1090f0f60def8007066f38b17
5646cef80070c2f848c001d2361f04e006f0010707eb0a0676082d1f0427
05f0070c07ea550506f0070645ea0c17b9f1040f47ea46264d46ce6000d2
0425b9f1030f05f00f06d6640e6865f347165d440e60def8006065f39e66
4d46cef8006000d20325079e05f0070555650a2e00d20a2606f03f059565
8d68059f66f38e2504eb0717b7fbf3f6402e8d6000d2402606f07f05109e
4ff0000c4ff00107052e03e08c7470ff487570ff5766c2e9175c00d20526
b0f5057f06f01f059566d56605d9099d04eb4505b5fbf3f500e04d46032d
00d203256e1c05f0070506f00f07baf10c0fc2f88470156755468f6866f3
d2378f6000d20c2505f01f065667049e059f04eb860604eb8717b7fbf3f7
b6fbf3f64c68ff2f65f34a2406f07f054c60956701d84ff48077c7f30904
c2e91f4cc2f888c00a6822f000420a600a9cfd4a12f814204c68424324f0
605040f4006002f2e732b2fbf3f262f3c8004860d8f8000040f4806062f3
0910c8f80000486820f0030048604ff400708a6860f3dc428a605be14ff0
0003c828089304d801244ff0030b23461fe0b0f5857f02d80224042304e0
b0f5a77f04d2032405239b46022311e0b0f5c87f04d8042403234ff0060b
09e0b0f5e97f02d80524072301e0062408239b46042300274c610124cf60
8c61b468b4f1805f01d3262600e04e26566105269661b4f1804f0e6846f0
03060e6004d3159c6646c2f81cc003e0049e019cd661049e022c8e7100d2
0224c4f3090414658f68ddf81cc064f30907bcf1030f8f6001d24ff0030c
0cf00f0646ea054515620e68139d6cf30b260595032d0e6001d3059d01e0
0325059505f03f0555630d68059e66f31445079e1396032e0d6001d3139d
01e00325139505f00f05d563b9f1020f0e6865f30f364d460e6000d20225
baf1030f05f00f06544656640e6865f384060e6000d203246ff03f0704f0
1f06654407eb44171c44966404eb0c06139c47f003070f612544139c2d1f
2644def8004066f3113465f38b14cef80040059c644404f03f059563def8
005064f30505cef800500d6864f35e65abeb0304a41c0d6054624d6825f0
04054d60def8005064f35955cef800504ff47a75089e109c9662c2e90bb3
022c00d2022404f00f06c82816640e6864f358560e60d8f8006064f30306
c8f8006001d94c4600e0109c022c00d2022404f00f06b9f1020fd664ab46
0e68cc4664f347161c440e60def8003064f39e63cef8003001d24ff0020c
01250cf007030224536500238f680326baf1030f6cf38e278f6093650a9f
d76540f2e737c2e918351667c2e91a548d6825f4f02505f5c0358d605546
53674e6826f4c0664e609367099bc2e91f3400d203254ff4fa7305f00f05
c828c2e921530a6822f000420a604a6822f0605202f1c05222f0e06242f4
00624a6001d3119804e0129807eb8000b0fbfbf0082800d2082060f3c802
4a60d8f8002042f4806260f30912c8f80020486820f003004860886864f3
dc4088600420def8001060f39441cef800106be14ff00003a628089303d8
01260324334633e0b0f5c87f03d80426062403232ce040f21523984203d8
06260824042324e0b0f5167f03d80726092405231de0b0f5277f02d20826
0a2405e040f2dd23984203d809260b2406230fe0b0f5487f02d80a260c24
f7e740f2a533984202d80c260e2401e00e26102408234e610126b0f5857f
8e6101d8002000e003200227c86100202626c860c2e90567086840f00300
0860dbf80800b0f1005f04d915986646c2f81cc003e0049e0198d661049e
02288e7100d20220c0f3090010658e6860f3090607988e60032800d20320
00f00f0646ea054515620e6801e0f47470ff139d60f30b260595032d0e60
01d3059d01e00325059505f03f0555630e68059dddf81cb065f31446bbf1
030f0e6001d24ff0030bb9f1040f0bf00f06cc46d6630d6866f30f350d60
01d24ff0040cbaf1040f0cf00f05556455460e686cf384060e6000d20425
6ff03f0705f01f06844407eb45171d4447f00307966405440f6105eb0b07
def800500ceb0b06361f67f3113566f38b15cef80050059d284400f03f05
9563def8005060f30505cef800500d6860f35e65e01a801c0d6050624d68
25f004054d60def8005060f35955cef80050089d10989562c2e90b430228
00d2022000f00f04b9f1040f14640c6860f358540c60d8f8004060f30304
4846c8f8004000d20420b9f1030f00f00f040344d4640c6860f347140c60
4c46def8000063f39e60cef8000001d24ff003044ff0020304f007004ff0
010650654ff000008d6864f38e254c468d6090650a9dc2e91963d366c2e9
175001d24ff00304baf1030f14678d6864f3d23554468d604ff004055067
4e6826f4c0664e6090670998c2e91f0500d203244ff4fa7004f00f04c2e9
2140086820f000400860486820f0605000f1c05020f0e06040f400621198
4a60082800d2082060f3c8024a60d8f8002042f4806260f30912c8f80020
486820f003004860886863f3dc408860def8000065f39440cef800000f98
17b0bde8f08f2de9f047dff8f083fc49d8f800000a68121dc0eb0011f948
92e8d00001eb4101222200eb810104f1c00001f18c0501f1ac0901f1b00a
091d00f059fb0322294606f1340000f053fbd9f80000f96840ead170f860
daf80000b8634046d8f80010022904d0012902461fd0f1b14be0287b8007
11d00021e24ad4f880001040084340f4a020c4f88000d8f80c00fa28d4f8
e80003d8c01e02e00121ece7801ec4f86002d4f8ec00401e2be0287c00f0
070003282bd002282cd04ff44010d268c82a2ad249b3d4f8801021f47c11
014341f43020c4f88000b06bb16bf26ac0f3c260c1f30263c01a22f4fc61
41ea401141ea0020f062d4f8e800401ec4f86002d4f8ec00c4f854020020
bde8f0874ff40010d4e74ff48010d1e7d4f8801021f47c11014341f4e020
d4e72de9f041b348b14e016830688d68c0eb001000eb4002a868696cae4b
c0f3834803eb820401f00107042204f1980105f1400000f0c8fa30680228
03d001284ad0a8b36de0f1684ff40030fa2930d9b4f89c10c1f30c0140ea
01124ff00301404697b1983400f0bafa20880321c0f30c0040f480700201
404600f0b0fa98490220884734f8980903e000f0a8fab4f898000321c004
c20b404600f0a0fab4f8a0104ff48020c1f30c0140ea011234e012e0d4f8
9c1041f001016964b4f89c109834c1f30c0141f0010140ea011203214046
00f084fad5e714f89c1f102040ea01320321404600f07afa2179202040ea
01320321404600f072fa217a30209c3c40ea01320321404600f069fa3068
40b994f8a810b02040ea01320321404600f05efa0020bde8f0816e4840f2
be2102690a430261426931ea0202fbd17047694840f29e2102698a430261
42690a42fcd170472de9f05f8346dff8749100245e49dff884815b4dd9f8
0000c0eb001000eb400001eb800000f18c0a08eb84102860017cd0e90176
032932d200f009ff0021bbf1fa0fc7f81c1118d8d9f80000022814d1b168
daf8100040f001007064c1f38340baf81010c1f30c0242f001024ff40031
41ea0212032100f009fa00f04bff002000f0aefa2868017801200c318840
424940ea0040c1f8700101203c498847641c022cc1d3bde8f09f2de9f047
4ff00108394f0024334e4546dff8e090dff8c0a007eb84103060017c0329
1ad201780c3108fa01f00004c9f87001daf80c0000f07ffa00f09af800f0
b2fefff74dfefff7dffe00f0dff800f09eff054600f0cafe25b1641c022c
dbd32846c1e624a0fff792f8f9e710b50021fff7e3f80446fff7eaf82046
fff76cff01212046fff7d9f81348c460bde81040b6e770b50020fff75fff
154c4ff4401020650120104da8474ff00210e0610120a8470e4b0020084a
03eb801111600c7c8968032c03d2cc6a24f04054cc62401c0228f1d370bd
8c7470ff407570ff487570fffefff0fff125fdff000073ff647770ff0000
76ff445454206661696c6564210a000000002de9f0410020694b4ff47a74
684a03eb801111600d7c8968032d03d2cd6a45f04055cd62401c0228f1d3
4ff40030614d614e624fe8610120b047d7f88402800602d4641e002cf6dc
5d482865bde8f04153e75c4a10b51524c2e90004a307c2e902310846fff7
70f8002010bd504870b5006884686169456821f080416161d4f8cc0120f0
8040c4f8cc01d4f80c0220f08040c4f80c02d5f88400c0070bd1d4f84c02
20f08040c4f84c02d4f88c0220f08040c4f88c0201203f4eb047606940f0
80406061d4f8cc0140f08040c4f8cc01d4f80c0240f08040c4f80c02d5f8
8400c0070bd1d4f84c0240f08040c4f84c02d4f88c0240f08040c4f88c02
b446bde87040012060472a482e4b00681a68d0e90110022a00d0b2bbda68
b2f5857f33d9d0f8c02142f4c062c0f8c021d0f8002242f4c062c0f80022
d1f88410c9070bd016e0d0f8401221f4c061c0f84012d0f8801221f4c061
09e0d0f8401241f4c061c0f84012d0f8801241f4c061c0f880128168c1f3
83421449012a01d9c0f89011c0f880117047ffe7d0f8c02122f4c062c0f8
c021d0f8002222f4c062c0f80022d1f88410c907ccd0e2e70000647770ff
407570ff000076fff125fdff000077ff100030008c7470ff390b0110fe49
012270b501280968fd4b4d68d1e90240d5f8846049d026f00106c5f88460
097808318a401104c3f84412c16821f00041c160d4f8400240f00100c4f8
4002d4f8800240f00100c4f88002d5f8c000fa280bd9d4f84c0220f00040
c4f84c02d4f88c0220f00040c4f88c02d4f84c0220f08040c4f84c02d4f8
8c0220f08040c4f88c020a20df4904f513748847206840f080402060206c
40f080402064d5f8c40240f00400c5f8c40270bd46f00106c5f884600978
08318a4042ea0241c3f84412c16841f00041c160d4f8400220f00100c4f8
4002d4f8800220f00100c4f88002d4f84c0240f00040c4f84c02d4f88c02
40f00040c4f88c02d0e710b5002304e051f8234040f823405b1c9342f8d3
10bd42ea0050b94a0843136840f00042002059680a64401c0a28fcd3086c
0028fcdb7047f0b5b14f07f108003a6892f810c05468cceb0c1101eb4101
00eb8101d1f8ac00c0f382404000022808d004284ff4801606d0082806d0
102806d118e0002603e0002502e04ff4001601252222091d04f1c000fff7
b9ff0020bcf1000f014609d0bcf1010f07d0bcf1020f35d119e04ff44016
e9e70121d4f8e820521ec4f86022d4f8ec300022c4f85432c4f8c820d4f8
802002f04002324342f44b02c4f880201ae08948083090f80402c007d4f8
e80001d0c01e00e0801ec4f86002d4f8ec200120844e4ff4fa733543521e
c4f85422c4f8c830c4f8805001223e687b4d3378db1c02fa03f7984040ea
0740c5f84402307800eb400000f10a0302fa03f601fa03f343ea064600f1
090301fa03f702fa03f3083047ea03438140824041ea024006431e43c5f8
4c62206840f001002060f0bd654996280968896803d8086920f4000004e0
fa28086922d840f400000861486940f000404861d1f8cc0140f00040c1f8
cc01d1f80c0240f00040c1f80c02d1f84c0240f00040c1f84c02d1f88c02
40f00040c1f88c02486840f4003021e020f400000861486920f000404861
d1f8cc0120f00040c1f8cc01d1f80c0220f00040c1f80c02d1f84c0220f0
0040c1f84c02d1f88c0220f00040c1f88c02486820f40030486070472de9
f04782463e498ab0202201a801f06ee83748006884686168456841f08051
61606068012640f0110060603046dff8c880414688470322b30200214ff0
004e57074ff4397901a84ff0540cc4f8d420c4f8c030c4f8c410c4f8c410
c4f8c470c4f8c4c00091009a50f82220c4f8c420009a00eb82025368c4f8
c430c4f8c4e0c4f8c490009a921c082a0092ebd34ff020424ff41873c4f8
c4105700c4f8c410c4f8c420c4f8c430c4f8c410c4f8c410c4f8c470d5f8
dc209200db05c4f8c420c4f8c410c4f8c410c4f8c430d5f8d8300c4a9d00
0c4bc4f8c450c4f8cc20c4f8c830d4f8d820d207fbd04ff460630de04075
70ff000077fff125fdff200005004c7470ff710002f0011750004feaca02
c4f8c810c4f8c030009150f82110d4f8c430d140d3400906b1eb036f01d0
002604e00099491c08290091eed3606840f080506060606840f011006060
4146012088470ab03046bde8f0872de9ff5f0021fa486a46036808469c68
934642f82010401c0428f9d3002543f2070a4ff00008f3a0fef715fd2846
fef737fdf2a0fef70ffdd4f8c00120f00100e5b300210843c4f8c001d4f8
0002012d20f0010035d000210843c4f80002d4f84002022d20f001002dd0
00210843c4f84002d4f88002032d20f0010025d000210027084304eb8519
c4f880020026d9f8d40120ea0a00384340ea0631c9f8d4112846fff700ff
90b15bf825200121d4a001fa08f10a434bf8252009e0ffe70121c0e70121
c8e70121d0e70121d8e7cda0fef7c1fc761c08f10108042ed7d3c6a0fef7
b9fc7f1c062fd0d3c7a0fef7b3fc6d1c042d95d3d4f8c00140f00100c4f8
c001d4f8000240f00100c4f80002d4f8400240f00100c4f84002d4f88002
40f00100c4f8800204b00120bde8f09fb04810b500688468b5a0fef78dfc
d4f8c40104f5e274fef7c8fcb4a0fef784fc206cfef7c2fcb4a0fef77efc
d4f88000fef7bbfcb3a0fef777fcd4f8c000fef7b4fcb3a0fef770fc2069
fef7aefcb3a0fef76afc206dfef7a8fcb3a0fef764fcd4f89000fef7a1fc
b2a0fef75dfcd4f8d000fef79afcbde8104098a0fef754bc2de9fc418f48
ae4a0068d2e90012d0e901640020cde90012d6f8d0c0c6f8d000206b0027
022300f00700042805d0a06840f002010020a16000e00020dff884e2e846
616841f080516160a568626858f82010c5f383450a43022142ea0e026260
491c0a29fcd3d4f8c41135ea0101fad1d4f8041235ea0101fad1d6f88410
c90709d1d4f8441235ea0101fad1d4f8841235ea0101fad1e16811f4487f
01d0012702e0401c9842ccd3012d09d9002202212846fff724fd00220221
2846fff71ffd002202212846fff71afd002202212846fff715fd206b00f0
0700042803d0a06820f00200a060c6f8d0c017b10020bde8fc810120fbe7
2de9f04107225148dff84481006808f10808077cd0e90245d0f804c004f1
3400c7eb071101eb410108eb810606f18c01fff7dffc56f8ac0fe96840ea
d1713f20e9606861002071684ff0290e614a614b624ea963c5f83ce0a261
e361266227b1012f07d0022f57d12fe098f8a810890700d00120a16821f0
1f01891ca160dcf880104906216b21f4407101d401f580712163216b21f0
0701091d2163a16a21f47f6141f44461a162a16ba26be36ac1f3c261c2f3
0265491b23f4fc6242ea411242ea0121e16280b926e0a06820f01f00a060
206b20f00700c01c20631c480830b0f8040210f4117f16d0d4f8c00140f4
c060c4f8c001d4f8000240f4c060c4f80002d4f8400240f4c060c4f84002
d4f8800240f4c06015e0d4f8c00120f4c060c4f8c001d4f8000220f4c060
c4f80002d4f8400220f4c060c4f84002d4f8800220f4c060c4f88002bde8
f0810000407570ff42797465200000003a20000031200000302000000a00
00000a4458304753523a000000000a4458314753523a000000000a445832
4753523a000000000a4458334753523a000000000a44583044515354523a
00000a44583144515354523a00000a44583244515354523a00000a445833
44515354523a0000447470ff010000709baf22001d11ac0672a02d04f948
fa4a0068816800204a60401c0a28fcd3c868c0434007fbd170472de9f041
0124f14edff8c883d6f800c09cf8000000eb8000031dc21c811c04fa03f7
04fa02f3421c04fa01f547ea074743ea034104fa02f20f4345ea054304fa
00f01f4342ea0241dcf808500f4340ea00421743c8f8e0710120df4fb847
686920f080406861d5f8cc0120f08040c5f8cc01d5f80c0220f08040c5f8
0c02d5f84c0220f08040c5f84c02d5f88c0220f08040c5f88c020a20b847
686940f080406861d5f8cc0140f08040c5f8cc01d5f80c0240f08040c5f8
0c02d5f84c0240f08040c5f84c02d5f88c0240f08040c5f88c020a20b847
3068007800eb8000011d04fa01f2411c04fa01f1c31c04fa03f343ea0343
43ea0242831c04fa00f004fa03f343ea03431a4342ea014242ea0040c8f8
e0010a20b8473068007800eb8000011d04fa01f1821c04fa02f2431c04fa
03f3c51c04fa05f5844029431143194321430904c8f8e011bc46bde8f041
012060479e480068017c806802290dd09f4a4168114341600221491c0a29
fcd30921c26831ea0202fbd17047984a2032efe79248012238b504230168
0024d1e90101856815f00705009519d0012d12d0032d0ad0052df4d14360
856805f00705032dfad1cd68ad07fcd54260856805f00705012dfad14460
85686d07fcd1e0e738bd7e4818b5042301680122d1e90101846804f00704
012c009414d064b1032c0ad0052cf4d14360846804f00704032cfad1cc68
a407fcd54260846804f00704012cfad1e4e718bd6d4808b50168d1e90101
826802f00702032a009233d08268c2f30212012a04d1826802f00702052a
29d0009a72b1012a13d0052ae9d104224260826802f00702032afad1ca68
9207fcd5dee701224260826802f00702012afad102224260826802f00702
032ad0d08268c2f30212012af5d1826802f00702052af0d1c5e708bd4d48
022118b50123006803224068846804f00704052c009418d024b1012c08d0
032cf4d10be04360846804f00704012cfad14160846804f00704032cfad1
4260846804f00704052cfad1e0e718bd30b50546384800688468fff76fff
a06820f4701040ea8540a060bde8304088e710b50446fff762ff2046fff7
f5f9bde810407ee770b505462b480c460068c668fff754ff022c06d00421
0b20b1602860bde870406de70721f7e7f0b58446224816460f460068d0e9
0245fff73fff0420a860206b40f008010320022e2163ccf8000004d00b20
3860bde8f04051e70a20f9e72de9f041844613481e4690460f460068d0e9
0245fff721ff0420a860206b102140f008020320022e2263ccf800103860
05d00b21c8f80010bde8f04130e70a21f8e710b5fff709fffff7a7fc0446
fff727ff204610bd407570ff1f000010000076fff125fdff4100017070b5
0646f948b6f5805f4ff00105006844691dd20320fff775fffff7ddff50b1
f348002204eb0651226008600968814201d1206830b10120fff764fffff7
ccff10b105e0022503e0eaa0fef7c5f80025284670bd2de9f041e4480068
8468017c4569d4f8c061022904d001295ad0002963d072e0de492960fff7
bafe002203201146fff7d4f9df4901208847002201210320fff7ccf9d548
083000f5b47790f804124ff4203040ea011203210846fff7bef9d4f8c001
20f4c060c4f8c001d4f8000220f4c060c4f80002d4f8400220f4c060c4f8
4002d4f8800220f4c060c4f8800204f5e074fff7a6fe00212970fff77ffe
97f89c104ff4003040ea011203210846fff794f926602664c4f88060c4f8
c060fff790fe2868b5490f3988421ed0002024e5416bb1f5807f16d1416a
022913d1c0690a2812d00fe0416a02290cd1c1690b2902d00c2904d006e0
006b0e2805d002e0006b0f2801d0022007e5012005e52de9f04f0746a048
98460a9e93460c464ff001090068057cd0e902c08246fff736fedcf83000
b8f1030f07d020f00800ccf83000022e04d0012203e040f00800f6e70022
09982101974b801ac039a0f1090c41ea8801002241ea0c0133f812c08c45
03d0521c102af8d301e0102a02d34ff0000927e00db1012d22d1012f0dd1
022e02d0012e05d008e00a2806d10f2c08d003e00f2c01d10b2803d025b1
012d02d00ee00e220ce0012f03d0022f08d15c4506d1022e04d10b2802d1
0f2c00d10022caf80820fff705fe4846bde8f08f7648d0f89c00002800d0
01207047002070472de9f05f0127dff8a081d8f80000067c90e8320008f1
0800c6eb061202eb420250f82200814609b9fdf749ff49463046fef795ff
fff7d2fc4846fff780f9012e00d04eb9d4f8800040f04000c4f88000286b
40f00800286300f085f9fff7d6f8fff7bffb04204ff000094ff0010b26b1
012e02d0022e30d117e0062105234ff0030e4ff0830cc5f84090c5f844c0
a864c5f84cb0c4f8e490c4f8e810c4f8ece0c4f86032c4f854e217e04ff4
126c062205234ff0400ec5f840c0c5f844e0c5f84890c5f84c90c4f8e490
c4f8e820c4f8ec30c4f86002c4f85402fff771fcc4f844b0a06cc007fcd0
002203201146fff77cf8dff8cca0012051468847002201210320fff772f8
fff712fdfff74ffd0120fef7e2ffa86820f4701040f48020a8600eb1012e
12d151460a20884776b9d8f80000006850b9c4f86090802208210120fff7
53f8606ec04380070bd1fff7cefa10b1012e3cd06ae0d8f8041011b1012e
02d00eb1002762e0d8f80000007800eb8001091d0bfa01f0144940ea0040
c1f8e00151460a208847d8f80000007800eb8000001d0bfa00f10c480904
c0f8e01151460a208847aee7407570ff0ff0a55a43533020445454206572
720a00000000f125fdff6c7470ff000073ff000076ffd8f80000006890b1
7d4854f8801f4268d2f8802021f0400102f04002114321608068016b286b
090a61f3092016e0c4f86090802208210120fef7efff606e00f003000128
0bd1d4f8800020f04000c4f88000286b20f4407000f580702863fff795fc
3846bde8f09f2de9f04165480068d0e90164057cd6f8c000fdf7c8fe62a0
fdf7a0fefff7aafcfef7d8fffff7c1fa25b1012d02d0022d4bd123e05948
c5eb051101eb4101083000eb8107032117f8980f02030846fef7b0ff3879
102141ea003203210846fef7a8ff397a202040ea013203210846fef7a0ff
397b302040ea013222e047480321083000f5b47790f8000202010846fef7
90ff17f89c1f4ff4003040ea011203210846fef786ff39794ff4802040ea
011203210846fef77dff397a4ff4c02040ea011203210846fef774ff3748
c4f89001c4f88001a06820f4701040f48020a060fff7e8f9070020d0012d
00d0ddb900200446306608212006020d0120fef759ff2aa0fdf72bfe2046
fdf74dfe28a0fdf725fe706efdf763feaff60c20fdf71efe641c112ce6d3
fff748fc3846bbe5f0b500271a480324022301220068017c4068c0f8c422
1b4dc0f8c8420f26c0f8d842c0f8f052c0f84032c0f85022c0f86462c0f8
d432c0f8d032c0f87022022909d041b1c0f84472c0f84872c0f84c72c0f8
9072f0bd40f608024ff4e021c0f84422c0f84812f3e70000647770ff4075
70ff4d487a0a00000000390b01104d5200003d307800010107002de9ff4f
0d462f4983b080462c4801224ff47a7b01920268d207fcd1d1f800218946
1207fad14ff48061274c0091290a2a0c2b0e4fea18264fea184725724fea
186c61724ff4200ea272e372002384f80e80e6731a492774dff864a00831
84f811c00a1d081fc1f800e014600360daf80000c007fbd15e46dff850a0
4f4603e0514601208847761ed7f80001000702d0002ef5d10de066b10598
401e059000980544804405980028c1d1019807b0bde8f08f0020019006a0
fdf774fdf5e70000000db2ff0000b2ff207570fff125fdff444d41207469
6d656f75742000000000f0412de9202052e20b00003a800052e30500003a
80f0d1f5f851b1e8202042e2800052e3f851a0e8f9ffff2af851b1e82020
52e2f851a0e8fbffff2a02ceb0e11850b1281850a0281800b1481800a048
f041bde802cfb0e104309124043080241eff2f01822fb0e1b230d1200120
d144b230c0200120c0441eff2fe140000000200000008000000000010000
8000000000010000ff6600995533aacc5533aacc66ff990066ff99003355
ccaa3355ccaa0066ff99b2011d002d003d004d001e002e003e001c002c00
3c00280019000a00c1014e00000000000000000000000000000000005555
000055650000555566005565760055658600555566775555768755658697
556586a7555566775555668755557697556586a755556687555576876565
7697656586a755556677555566875555769765657697656586a732323235
3231323332352d2f2d302d322d33282d282f28302831232d232e232f2330
232c232d232e232f3235bc0171401c00bc0020000060bc02200008602001
223f04083c02380600ffffff00000000000000002c010000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000002c010000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000002c010000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000061ff0000
62ff0000acff030000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000010000000000
63ff000064ff8000acff0300000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000
000000000000000000000100000000000000010000000000000001000000
000000000100000000000000afbeadde
EOF

					xxd -r -ps /tmp/memory_300Mhz.hex /tmp/memory_300Mhz.bin

					echo "01a83447fe59eba51a7cf8d2a307c5b8  /tmp/memory_300Mhz.bin" > /tmp/md5check

					if [ $(md5sum -c /tmp/md5check 1>/dev/null 2>/dev/null) ]; then
						echo "memory_300Mhz md5check failed!";
						exit 1
					fi

					dd if=/tmp/memory_300Mhz.bin conv=sync 2>/dev/null | split -b 512 --filter='openssl rc4 -K 7C4E0304550509072D2C7B38170D1711' > /tmp/FlashData.bin

					rm /tmp/md5check /tmp/memory_300Mhz.bin /tmp/memory_300Mhz.hex

					dd if=/etc/uboot-env/u-boot.bin conv=sync 2>/dev/null | split -b 512 --filter='openssl rc4 -K 7C4E0304550509072D2C7B38170D1711' > /tmp/FlashBoot.bin

cat << \EOF > /tmp/parameters
FIRMWARE_VER:4.4.2
MACHINE_MODEL:rk30sdk
MACHINE_ID:007
MANUFACTURER:RK30SDK
MAGIC: 0x5041524B
ATAG: 0x60000800
MACHINE: 3066
CHECK_MASK: 0x80
KERNEL_IMG: 0x60408000
#RECOVER_KEY: 1,1,0,20,0
CMDLINE:console=ttyFIQ0 root=/dev/mmcblk0p1 rootfstype=ext4 initrd=0x62000000,0x00800000 mtdparts=rk29xxnand:0x00002000@0x00002000(uboot),0x00002000@0x00004000(misc),0x00008000@0x00006000(kernel),0x00010000@0x0000e000(boot)
EOF

					rkcrc -p /tmp/parameters /tmp/parameter.img
					rm /tmp/parameters 1>/dev/null 2>/dev/null

					rkcrc -k /boot/zImage /tmp/kernel.img

					dd if=/tmp/idb_sector_0.enc of=/dev/mmcblk0 conv=sync,fsync,notrunc seek=64 2>/dev/null
					dd if=/tmp/idb_sector_1 of=/dev/mmcblk0 conv=sync,fsync,notrunc seek=65 2>/dev/null
					dd if=/tmp/FlashData.bin of=/dev/mmcblk0 conv=sync,fsync,notrunc seek=68 2>/dev/null
					dd if=/tmp/FlashBoot.bin of=/dev/mmcblk0 conv=sync,fsync,notrunc seek=100 2>/dev/null
					dd if=/tmp/parameter.img of=/dev/mmcblk0 conv=sync,fsync,notrunc seek=$((0x2000+0x0)) 2>/dev/null
					dd if=/tmp/kernel.img of=/dev/mmcblk0 conv=sync,fsync,notrunc seek=$((0x2000+0x6000)) 2>/dev/null
					dd if=/tmp/kernel.img of=/dev/mmcblk0 conv=sync,fsync,notrunc seek=$((0x2000+0xe000)) 2>/dev/null

					rm /tmp/idb_sector_1 /tmp/idb_sector_0.enc /tmp/FlashBoot.bin /tmp/FlashData.bin /tmp/parameter.img  2>/dev/null
        fi

        INITRD=No run-parts --new-session --report -a $KVER /etc/kernel/postinst.d > /dev/null 2>&1

fi

echo "xbian-package-kernel" >>  /var/run/reboot-required || :

exit 0					